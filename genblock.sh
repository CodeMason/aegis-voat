h=(
'0.r.msn.com'
'a.ads1.msn.com'
'a.ads2.msads.net'
'a.ads2.msn.com'
'ac3.msn.com'
'ad.doubleclick.net'
'ads1.msads.net'
'ads1.msn.com'
'ads2.msn.com'
'ads.eu.msn.com'
'adsmockarc.azurewebsites.net'
'ads.msn.com'
'adsyndication.msn.com'
'aidps.atdmt.com'
'ajax.aspnetcdn.com'
'aka-cdn-ns.adtech.de'
'analytics.live.com'
'analytics.microsoft.com'
'analytics.msnbc.msn.com'
'analytics.msn.com'
'analytics.r.msn.com'
'appexmapsappupdate.blob.core.windows.net'
'a.rad.msn.com'
'arc2.msn.com'
'arc3.msn.com'
'arc9.msn.com'
'auth.gfx.ms'
'az361816.vo.msecnd.net'
'az512334.vo.msecnd.net'
'b.ads1.msn.com'
'b.ads2.msads.net'
'bat.bing.com'
'bingads.microsoft.com'
'blu.mobileads.msn.com'
'b.rad.msn.com'
'bs.serving-sys.com'
'c1.microsoft.com'
'c.atdmt.com'
'c.bing.com'
'cdn.atdmt.com'
'cdn.content.prod.cms.msn.com'
'cdp1.public-trust.com'
'cds26.ams9.msecn.net'
'choice.microsoft.com'
'choice.microsoft.com.nsatc.net'
'c.microsoft.com'
'c.msn.com'
'cmsresources.windowsphone.com'
'c.ninemsn.com.au'
'c.no.msn.com'
'col.mobileads.msn.com'
'compatexchange.cloudapp.net'
'content.windows.microsoft.com'
'corpext.msitadfs.glbdns2.microsoft.com'
'corp.sts.microsoft.com'
'cs1.wpc.v0cdn.net'
'c.s-microsoft.com'
'db3aqu.atdmt.com'
'dc.services.visualstudio.com'
'dev.virtualearth.net'
'df.telemetry.microsoft.com'
'diagnostics.support.microsoft.com'
'digg.analytics.live.com'
'displaycatalog.md.mp.microsoft.com'
'dl.delivery.mp.microsoft.com'
'dmd.metaservices.microsoft.com'
'download-ssl.msgamestudios.com'
'ec.atdmt.com'
'ecn.dev.virtualearth.net'
'en-us.appex-rf.msn.com'
'fe2.update.microsoft.com.akadns.net'
'fe3.delivery.mp.microsoft.com'
'feedback.microsoft-hohm.com'
'feedback.search.microsoft.com'
'feedback.windows.com'
'ff4a487e56259f4bd5831e9e30470e83.azr.msnetworkanalytics.testanalytics.net'
'flex.msn.com'
'geo-prod.do.dsp.mp.microsoft.com'
'g.msn.com'
'h1.msn.com'
'h2.msn.com'
'help.bingads.microsoft.com'
'i1.services.social.microsoft.com'
'i1.services.social.microsoft.com.nsatc.net'
'iecvlist.microsoft.com'
'ieonline.microsoft.com'
'images.adsyndication.msn.com'
'img-s-msn-com.akamaized.net'
'inference.location.live.net'
'js.microsoft.com'
'lb1.www.ms.akadns.net'
'licensing.md.mp.microsoft.com'
'live.rads.msn.com'
'livetileedge.dsx.mp.microsoft.com'
'logging.windows.microsoft.com'
'm.adnxs.com'
'mediadiscovery.microsoft.com'
'msftncsi.com'
'msnbot-65-55-108-23.search.msn.com'
'msnportal.112.2o7.net'
'msntest.serving-sys.com'
'oca.telemetry.microsoft.com'
'oca.telemetry.microsoft.com.nsatc.net'
'otf.msn.com'
'popup.msn.com'
'pre.footprintpredict.com'
'r20swj13mr.microsoft.com'
'rad.live.com'
'rad.msn.com'
'redir.metaservices.microsoft.com'
'reports.wes.df.telemetry.microsoft.com'
'rmads.eu.msn.com'
'rmads.msn.com'
'rpt.rad.msn.com'
'sb.scorecardresearch.com'
'schemas.microsoft.akadns.net'
'secure.adnxs.com'
'secure.flashtalking.com'
'services.wes.df.telemetry.microsoft.com'
'settings.data.microsoft.com'
'settings-sandbox.data.microsoft.com'
'settings-ssl.xboxlive.com'
'settings-win.data.microsoft.com'
'sgmetrics.cloudapp.net'
'shell.windows.com'
'sls.update.microsoft.com'
'sls.update.microsoft.com.akadns.net'
'sls.update.microsoft.com.nsatc.net'
'sO.2mdn.net'
'spynet.microsoft.com'
'spynet2.microsoft.com'
'spynetalt.microsoft.com'
'sqm.df.telemetry.microsoft.com'
'sqm.microsoft.com'
'sqm.telemetry.microsoft.com'
'sqm.telemetry.microsoft.com.nsatc.net'
'ssw.live.com'
'static.2mdn.net'
'statsfe1.ws.microsoft.com'
'statsfe2.update.microsoft.com.akadns.net'
'statsfe2.ws.microsoft.com'
'storeedgefd.dsx.mp.microsoft.com'
'survey.watson.microsoft.com'
't0.ssl.ak.dynamic.tiles.virtualearth.net'
't0.ssl.ak.tiles.virtualearth.net'
'telecommand.telemetry.microsoft.com'
'telecommand.telemetry.microsoft.com.nsatc.net'
'telemetry.appex.bing.net'
'telemetry.microsoft.com'
'telemetry.urs.microsoft.com'
'tile-service.weather.microsoft.com'
'tlu.dl.delivery.mp.microsoft.com'
'udc.msn.com'
'urs.microsoft.com'
'version.hybrid.api.here.com'
'view.atdmt.com'
'vortex-bn2.metron.live.com.nsatc.net'
'vortex-cy2.metron.live.com.nsatc.net'
'vortex.data.microsoft.com'
'vortex-sandbox.data.microsoft.com'
'vortex-win.data.microsoft.com'
'watson.live.com'
'watson.microsoft.com'
'watson.ppe.telemetry.microsoft.com'
'watson.telemetry.microsoft.com'
'watson.telemetry.microsoft.com.nsatc.net'
'wes.df.telemetry.microsoft.com'
'www.modern.ie'
'www.msftncsi.com'
);

l1=;l2=;l3=;l4=;l5=;
bl=block.cmd;ub=unblock.cmd;

d(){ dig @8.8.8.8 +short ${@} 2>/dev/null; };

for l in ${h[@]}; do l1=(${l1[@]} $(d ${l}));done;
for l in ${l1[@]};do l2=(${l2[@]} $(d ${l}));done;
for l in ${l2[@]};do l3=(${l3[@]} $(d ${l}));done;
for l in ${l3[@]};do l4=(${l4[@]} $(d ${l}));done;
for l in ${l4[@]};do l5=(${l5[@]} $(d ${l}));done;

l=$(printf '%s\n' ${l1[@]} ${l2[@]} ${l3[@]} ${l4[@]} ${l5[@]}|
sed 's/\.$//g'|grep -v [a-z]$|sort -t . -k 1,1n -k 2,2n -k 3,3n -k 4,4n|uniq);

>${bl};>${ub};
for x in ${l[@]};do printf '%s\n' "route -p add ${x}/32 0.0.0.0 >nul 2>nul" >>${bl};done;
for x in ${l[@]};do printf '%s\n' "route del ${x} >nul 2>nul" >>${ub};done;
printf '%s\n' 'exit'|tee -a ${bl} ${ub};
